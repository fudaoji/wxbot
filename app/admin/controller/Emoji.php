<?php
/**
 * Created by PhpStorm.
 * Script Name: Emoji.php
 * Create: 7/28/22 12:38 PM
 * Description:
 * Author: fudaoji<fdj@kuryun.cn>
 */

namespace app\admin\controller;


use app\common\model\EmojiCode;

class Emoji extends Base
{
    /**
     * @var \ky\Emoji
     */
    private $emoji;

    public function initialize()
    {
        parent::initialize(); // TODO: Change the autogenerated stub
        $this->model = new EmojiCode();
        $this->emoji = new \ky\Emoji();
    }

    public function index(){
        $type = input('type','normal');
        $where = [];
        $data_list = $this->model->page(120, $where, [], true, true);
        foreach ($data_list as $k => &$v){
            $bytes = $this->emoji->utf8Bytes($this->emoji->unifiedToHex($v['unified']));
            $v['image'] = $this->emoji->emojiUnifiedToHtml($bytes);
            $data_list[$k] = $v;
        }
        $pager = $data_list->render();
        $assign = ['data_list' => $data_list, 'pager' => $pager, 'type' => $type];
        return $this->show($assign);
    }
}